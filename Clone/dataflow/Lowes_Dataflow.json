{
	"name": "Lowes_Dataflow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "LowesPOSBLOBOutput",
						"type": "DatasetReference"
					},
					"name": "LowesPosBlob"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "charlotte0pipe0metastore",
						"type": "LinkedServiceReference"
					},
					"name": "sink1",
					"rejectedDataLinkedService": {
						"referenceName": "charlotte0pipe0metastore",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "Renamefields"
				},
				{
					"name": "JoinHash"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "select1"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "cast3"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Field_1 as string,",
				"          Field_2 as string,",
				"          Field_3 as string,",
				"          Field_4 as string,",
				"          Field_5 as string,",
				"          Field_6 as string,",
				"          Field_7 as string,",
				"          FileDate as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> LowesPosBlob",
				"cast3 select(mapColumn(",
				"          Lowes_Product = Field_1,",
				"          UPC_Number = Field_2,",
				"          Material = Field_3,",
				"          Type = Field_4,",
				"          UOM = Field_5,",
				"          Store = Field_6,",
				"          Value = Field_7,",
				"          FileDate",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Renamefields",
				"Renamefields, derivedColumn1 join(Renamefields@Lowes_Product == select1@Lowes_Product",
				"     && Renamefields@Type == select1@Type",
				"     && Renamefields@Store == select1@Store",
				"     && Renamefields@FileDate == select1@FileDate,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinHash",
				"select1 derive(HashKey = sha2(256, columns())) ~> derivedColumn1",
				"Renamefields select(mapColumn(",
				"          Lowes_Product,",
				"          Type,",
				"          Store,",
				"          FileDate",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"JoinHash derive(UploadDate = toDate(Renamefields@FileDate, 'yyyyMMdd')) ~> derivedColumn2",
				"LowesPosBlob cast(output(",
				"          Field_7 as double",
				"     ),",
				"     errors: true) ~> cast3",
				"derivedColumn2 sink(allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     input(",
				"          Lowes_Product as string,",
				"          UPC_Number as string,",
				"          Material as string,",
				"          Type as string,",
				"          UOM as string,",
				"          Store as string,",
				"          Value as double,",
				"          FileDate as string,",
				"          HashKey as string,",
				"          UploadDate as date",
				"     ),",
				"     format: 'delta',",
				"     fileSystem: 'raw-data',",
				"     folderPath: 'Retail_POS/Lowes/LowesDelta',",
				"     overwrite: true,",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['HashKey'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}